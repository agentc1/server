# Ada/SPARK server starter (proofs-first, Ravenscar/Jorvik)

This is a drop-in starter repo that swaps “tests & mocks first” with “contracts & proofs first,” suitable for agentic coding loops. It runs on Ada/SPARK and targets Ravenscar or Jorvik via a config pragma file.

## Quick start
```bash
# choose the runtime profile (Jorvik by default)
make -C . profile PROFILE=Jorvik   # or PROFILE=Ravenscar

# run proofs (flow + AoRTE + functional where specified)
make -C . prove
```

## Git hook gate (like tests in TDD)
```bash
git config core.hooksPath scripts/hooks
# optional: set a default profile for the hook
export PROFILE=Jorvik  # or Ravenscar
# now every commit runs gnatprove and will be blocked on unproved checks
```
You can unset the hook at any time via:
```bash
git config --unset core.hooksPath
```

## Layout
```
contracts/            # natural-language spec + proof plan
src/                  # SPARK core
src_boundary/         # tiny non-SPARK adapters (I/O etc.)
config/profiles/      # gnat.adc variants (Ravenscar|Jorvik)
scripts/hooks/        # pre-commit gate
server_starter.gpr    # project file
gnat.adc              # (generated by `make profile`) active Profile pragma
```

## Notes
- The example includes:
  - A small ring-buffer `Msg_Queue` as a protected object with simple contracts.
  - A tiny `Request_Parser` with safe scanning and loop invariants.
  - A boundary wrapper `Net_Spec` that your SPARK core depends on, implemented via a non‑SPARK body that calls `Net.Recv` (your actual OS/socket binding).
- Strengthen contracts over time and keep `make prove` green; that is your agent’s “objective gate.”
